---
title: "Forschungsbericht_Wirecard_final"
author: "Collar-Crime"
date: "Sommersemester 2021"
output:
  word_document:
    toc: yes
    toc_depth: '3'
  html_document:
    df_print: paged
    toc: yes
    toc_depth: 3
    number_sections: yes
  pdf_document:
    toc: yes
    toc_depth: '3'
  subtitle: Analyse des Beziehungsnetzwerks des   Unternehmens Wirecard
---

# Abstract

Der vorliegende Forschungsbericht untersucht die Beziehungsnetzwerke rund um den inzwischen insolventen, ehemals börsennotierten deutschen Zahlungsdienstleister Wirecard AG. Das entstandene Netzwerk ist ein ungerichtetes Two-Mode Akteursnetzwerk von 105 Akteuren. Die Netzwerkanalyse zeigt, dass

## Keywords

Netzwerkanalyse, Broker-Funktion, Cliquen, Meinungsführer, Wirecard, White-Collar-Crime, Teilnetzwerke, Akteursnetzwerk, Wirecard

# 1. Einleitung

Die Wirecard AG ist ein ehemals börsennotierter deutscher Zahlungsdienstleister. Seit dem 25. Juni 2020 ist das Unternehmen insolvent, da bekannt wurde, dass in der Bilanz mit 1,9 Milliarden Euro auf Treuhandkonten gerechnet wurde, die laut Angaben des Unternehmens nicht existierten. Durch die häufige Berichterstattung in den Medien wurden die Autorinnen und Autoren dieses Forschungsberichts auf das Thema aufmerksam. Eine große Rolle bei der Motivation, die Netzwerkanalyse zum Thema Wirecard durchzuführen, spielte ohne Zweifel der vorhandene Crime-Faktor.

Als Folge der Wirecard-Insolvenz wurde in der 19. Wahlperiode des Deutschen Bundestages am 1. Oktober 2020 auf Antrag der Fraktionen FDP, Die Linke und Bündnis 90/Die Grünen beschlossen, einen Untersuchungsausschuss einzurichten, der die Rolle der Bundesregierung im Kontext mit den Vorkommnissen bei der Wirecard AG aufklären soll. Die Teilnehmerlisten aus den öffentlichen Sitzungen des Untersuchungsausschusses bis zum 11. Februar dienten uns als Quelle für unsere Datenerhebung. Darüber hinaus haben wir unsere Daten durch systematische Auswertung der Berichterstattung in der deutschen Presse (insbesondere DER SPIEGEL und Handelsblatt) und in der internationalen Presse (Financial Times) erhoben. Die Datenerbebung insgesamt fand vom 28. Dezember 2020 bis zum 19. Februar 2021 statt.

Wir haben uns in dieser Netzwerkanalyse mit zwei Fragen intensiv auseinandergesetzt, die uns aber zzu unserer finalen Forschungsfrage geführt haben:

## 1.1. Kontaktnetzwerk Wirecard

Welche Kontaktintensität besteht zwischen Mitarbeitern von Wirecard und anderen Akteuren und Organisation außerhalb des Unternehmens? Für das Beziehungsnetzwerk *Contacts* wurde die Häufigkeit eines Kontakts zwischen einer Person/Organisation/Behörde mit dem Attribut weight gewichtet.\
Ziel dieser Frage war es herauszufinden, wie häufig und intensiv Mitarbeiter von Wirecard Kontakte zu anderen Personen und Organisationen außerhalb des Unternehmens hatten, um damit relevante Akteure außerhalb des Unternehmens zu identifizieren.

## 1.2. Verbindungsnetzwerk Wirecard

Welche Art der Beziehung besteht zwischen den Mitarbeitern des Unternehmens und den Akteuren außerhalb des Unternehmens? Für das Verbindungsnetzwerk *Ratio* wurde die Art der Beziehung zwischen Wirecard und der jeweiligen Person/Organisation/Behörde begutachtet.\
Ziel dieser Frage war es herauszufinden, welche Akteure außerhalb des Unternehmens wie relevant gewesen sind, sodass sie Teil des Unterstützernetzwerks der kriminellen Machenschaften der Wirecard AG sein könnten.

## 1.3. Broker-Positionen im Netzwerk

Insgesamt interessieren uns aber insbesondere die Akteure und Organisationen, die entscheidende Broker-Positionen im Wirecard-Netzwerk einnehmen.

# 2. Vorarbeiten und vergleichbare Studien

## 2.1. Forschungsstand

Im Bereich der sozialen Netzwerkanalyse war John Atkinson Hobson Ende des 19. Jahrhunderts einer der ersten, der systematisch Verbindungen von Organisationen untersuchte. Er erstellte eine einfache Tabelle von großen südafrikanischen Firmen und deren Vorstandsmitgliedern. Er zeigte damit, wie die Firmen De Beers und Rand Mines durch gemeinsame Vorstände eine große Anzahl von Firmen kontrollieren konnten. Die Netzwerkanalyse gewinnt immer mehr an Bedeutung für die Organisationsforschung, um informelle Beziehungen sichtbar zu machen, wie Jörg Raab im Handbuch der Netzwerkforschung erklärt. Dieselbe Ansicht teilt Richard Pircher, da normale Hierarchien nicht im Stande sind, die Beziehung einzelner Mitarbeiter untereinander zu betrachten. In Deutschland ist die Zahl der Organisationsforscher, die die Netzwerkanalyse verwenden, ziemlich klein. Aus diesem Grund greift das Forschungsdesign hauptsächlich die Studie von Burgess und Shaw auf, und lehnt sich an die Arbeit von Ronald Burt an, der in mehreren Studien zeigte, dass Manager verschiedene Cluster innerhalb eines Netzwerkes als sogenannte Broker miteinander verbinden.

Gerade bei Unternehmen, die im Wirtschaftssektor tätig sind, ist eine Netzwerkanalyse äußerst wichtig. Laut einer aktuellen KPMG Studie aus dem Jahr 2020, war fast jedes dritte Unternehmen in Deutschland in den vergangenen zwei Jahren von Wirtschaftskriminalität betroffen. Die Gefahr und das Risiko davon betroffen zu sein, drohen laut einer Studie der KPMG aus dem Jahr 2011 nicht nur von extern, sondern auch von internen Mitarbeitern. Weltweit werden in 56 Prozent der Fälle Warnsignale ignoriert, was auch ein typisches Verhaltensmuster in Deutschland ist.

## 2.2. Arbeitshypothesen

# 3. Datenerhebung: Zugang, Bereinigung und Codebuch

## 3.1. Datenzugang

Die Daten wurden mithilfe der Protokolle des Untersuchungsausschusses, inländische (Handelsblatt, SPIEGEL) und ausländische Berichterstattung (Financial Times) erhoben.

## 3.2. Zugang zum Datensatz

Der Datensatz ist unter [Github](https://github.com/elenagrunow/SNA/tree/main/wirecard/network) verfügbar.

## 3.3. Codebuch

Das [Codebuch](https://github.com/elenagrunow/SNA/blob/main/wirecard/network/Codebuch.Rmd) beschreibt die Variablen, Relationen und Gewichte des Netzwerks und ist ebenfalls auf Github hinterlegt.

# 4. Analyse und Interpretation

## 4.1. Das Gesamtnetzwerk

Das Gesamtnetzwerk umfasst 105 Knoten und 130 Beziehungen (siehe igraph-Objekt). Es ist ungerichtet und gewichtet nach der Häufigkeit und der Art des Kontakts.

```{r Gesamtnetzwerk, include=FALSE, echo=FALSE, message=FALSE, warning=FALSE, paged.print=TRUE}
# erste Visualisierung des Pretests zur Wirecard-Erhebung

library(igraph)

# liest die Edgelist als "el" ein
el <- read.csv("https://raw.githubusercontent.com/elenagrunow/SNA/main/wirecard/network/edge_wirecard.csv", header=T, as.is=T, sep = ",")

# liest die Nodelist mit den Namen ein
nodes <- read.csv("https://raw.githubusercontent.com/elenagrunow/SNA/main/wirecard/network/node_wirecard.csv", header=T, as.is=T, sep = ",")


# Zwischenschritt verbindet die Edge- und Nodelist zu einer Matrix
wc_matrix <- as.matrix(el)


# generiert ein igraph-Objekt (dataframe) aus der Matrix, das gerichtet ist (directed = true)
wc <- graph_from_data_frame(d=wc_matrix, vertices = nodes, directed=FALSE)

# ruft unser neues igraph-Objekt auf
wc

# generiert die Standard-Visualisierung des Netzwerks
plot(wc)

# definiert einige grafische Elemente, damit wir diese nicht immer wieder eingeben müssen
E(wc)$arrow.size <- .1
E(wc)$color="darkblue"
E(wc)$width <- E(wc)$weight
E(wc)$curved=.2
V(wc)$color = "lightblue"
V(wc)$frame.color = "white"
V(wc)$label.dist = 3
V(wc)$label.degree=6
V(wc)$label.cex=.8
V(wc)$label.family="Helvetica"
V(wc)$label.font=1
V(wc)$label.color="darkblue"

degree <- degree(wc)
degree

# einfacher plot

plot(wc,
     vertex.size =10,
     main="Wirecard-Netzwerk",
     sub="Collar-Crime",
     vertex.label=V(wc)$name2)

```

### 4.1.1. Beschreibung des Netzwerks

```{r Beschreibung des Netzwerks, include=FALSE, message=FALSE, warning=FALSE, paged.print=TRUE}
# Parameter zu Beschreibung des Netzwerks

## ist das Netzwerk bereits vereinfacht?
is.simple(wc)

## besteht das Netzwerk aus Komponenten?
## wenn ja, wie vielen?
is.connected(wc)
components(wc)

## Dichte des Netzwerks
edge_density(wc, loops=FALSE)

## Umfang des Netzwerks
diameter(wc)

## Pfaddistanzen (Distance)
farthest_vertices(wc)
```

Das Hauptnetzwerk besteht aus einer Komponente mit 105 Knoten. Die Dichte im Netzwerk beträgt 2,4 Prozent von allen möglichen Verbindungen. Die Dichte gibt Auskunft über die realisierten Verbindungen. Die maximale Pfaddistanz beträgt 17 Schritte.

```{r Einfache Visualisierung des erstellten Objekt, fig.height=10, fig.width=14, message=TRUE, warning=FALSE, paged.print=TRUE}


plot(wc,
     asp=0, 
     layout=layout.kamada.kawai,
     edge.arrow.size=.5,
     vertex.size=10,
     main ="Übersicht Gesamtnetzwerk",
     vertex.label=V(wc)$name2)
```

### 4.1.2. Netzwerke vereinfachen

Der erste Überblick zeigt, dass das Netzwerk schnell unübersichtlich wird, weil hier das komplette Netzwerk mit aus den unterschiedlichen Quellen beinhaltet sind. Deshalb ist es sinnvoll, ein vereinfachtes Gesamtnetzwerk zu erstellen. Vereinfacht bedeutet in diesem Fall, dass visuell in Organisationen und Personen im Netzwerk unterschieden wird, damit die Beziehungen deutlicher werden und insgesamt eine bessere Übersichtlichkeit gewährleistet wird.

```{r Netzwerk nach Organisationen und Personen unterschieden}


# ruft unser neues igraph-Objekt auf
wc

E(wc)$arrow.size <- .1
E(wc)$color="black"
E(wc)$width <- E(wc)$weight
E(wc)$curved=.2
V(wc)[V(wc)$type == 1]$shape = "circle"
V(wc)[V(wc)$type == 2]$shape = "square"
V(wc)[V(wc)$type == 1]$color = "peru"
V(wc)[V(wc)$type == 2]$color = "royalblue"
V(wc)$frame.color = "white"
V(wc)$label.dist = 3
V(wc)$label.degree=6
V(wc)$label.cex=.8
V(wc)$label.family="Helvetica"
V(wc)$label.font=1
V(wc)$label.color="darkblue"


# einfacher plot

plot(wc,
     asp=0,
     layout=layout_in_circle,
     vertex.size=8,
     edge.curved=curve_multiple(wc),
     main="Wirecard-Netzwerk",
     sub="Collar-Crime",
     vertex.label=V(wc)$name2)

```

Erstellen des Gesamtnetzwerks ohne den Akteuer "Wirecard".
```{r}
library(igraph)

el <- read.csv("https://raw.githubusercontent.com/elenagrunow/SNA/main/wirecard/network/edge_wirecard.csv", header=T, as.is=T, sep = ",")

nodes <- read.csv("https://raw.githubusercontent.com/elenagrunow/SNA/main/wirecard/network/node_wirecard.csv", header=T, as.is=T, sep = ",")

wc_matrix <- as.matrix(el)

wc <- graph_from_data_frame(d=wc_matrix, vertices = nodes, directed=FALSE)

wc

wc_ow <- delete.vertices(wc, V(wc)[name2="Wirecard"])

# generiert die Standard-Visualisierung des Netzwerks
plot(wc_ow)

# definiert einige grafische Elemente, damit wir diese nicht immer wieder eingeben müssen
E(wc_ow)$arrow.size <- .1
E(wc_ow)$color="darkblue"
E(wc_ow)$width <- E(wc_ow)$weight
E(wc_ow)$curved=.2
V(wc_ow)$color = "lightblue"
V(wc_ow)$frame.color = "white"
V(wc_ow)$label.dist = 3
V(wc_ow)$label.degree=6
V(wc_ow)$label.cex=.8
V(wc_ow)$label.family="Helvetica"
V(wc_ow)$label.font=1
V(wc_ow)$label.color="darkblue"

degree <- degree(wc_ow)
degree

# einfacher plot

plot(wc_ow,
     vertex.size =10,
     main="Wirecard-Netzwerk",
     sub="Collar-Crime",
     vertex.label=V(wc_ow)$name2)


```

Der Hervorhebung der Broker-Personen im Netzwerk zeigt wie entscheidend diese Akteure, einmal Markus Braun, aber auch Jan Masalek waren beziehungsweise sind. Daraus kann man schlussfolgern, dass ohne diese Broker das Netzwerk in dieser Form nicht zustandekommen wäre. Dadurch hätte man den weitreichenden Betrug eher eindämmen oder auch von vornehinein verhindern können.

```{r Hervorhebung der populärsten Knoten im Netzwerk, fig.height=6, fig.width=10, message=FALSE, warning=FALSE, paged.print=FALSE}

# mit der Auswahl der Knoten lassen sich deren Rahmenfarben spezifisch angeben
V(wc)[V(wc)$name2 == "MB"]$color <- "green"
V(wc)[V(wc)$name2 == "JM"]$color <- "red"

plot(wc,
     layout=layout_as_star,
     vertex.size=15,
     # vertex.label.cex=2,
     # vertex.frame.color=NA,(muss ausgeschaltet sein, damit die Knoten visualisiert werden können
     edge.arrow.size=.5,
     edge.color="grey80",
     edge.width=E(wc)$weight/2, #halbiert den Wert der Gewichte, um eine bessere Darstellung zu ermöglichen
     edge.curved=.2,
     edge.curved=curve_multiple(wc),
     )

title("Gesamtnetzwerk vereinfacht", 
      sub = "beliebteste Knoten in grün (höchster Bewetweenness-Wert), rot (zweit-höchster Betweenness-Wert)",
      cex.main = 2, col.main= "black",
      cex.sub = 2, font.sub = 3, col.sub = "black")

```

## 4.2. Analyse der Teilnetzwerke: Edge- und Nodeattribute

Die Auswahl der Teilnetzwerke ist abhängig von der jeweiligen Forschungsfrage. Für dieses Netzwerk bietet sich ein Verlgeich zwischen den unterschiedlichen Quellen der Erhebung an, aber auch eine Differenzierung zwischen dem Kontakt- und dem Beziehungsnetzwerk.

### 4.2.1. Teilnetzwerke nach EDGE-Attributen

Die Selektion der Edge-Attribute geschieht folgendermaßen:

1)  \*\*source1\*\* Quelle der Berichterstattung, erste Nennung, d.h. Informationsquelle aus „Untersuchungsausschuss" (Bericht des Untersuchungsausschusses) sind mit (Wert = 1) aufgeführt.

2)  \*\*source1\*\* Quelle der Berichterstattung, zweite Nennung, d.h. Informationsquelle aus „Berichterstattung Inland" (Handelsblatt und Spiegel) sind mit (Wert = 2) aufgeführt.

3)  \*\*source1\*\*\
    Quelle der Berichterstattung, dritte Nennung, d.h. Informationsquelle aus „Berichterstattung Ausland" (Financial Times) sind mit (Wert 3) aufgeführt.

Dadurch ergeben sich folgende Quellen-Teilnetzwerke:

1)  **wc_ua** ungerichtetes Beziehungsnetzwerk aus Quelle: Untersuchungsausschuss (1)

2)  **wc_bi** ungerichtetes Beziehungsnetzwerk aus Quelle: Inland (Spiegel und Handelsblatt) (2)

3)  **wc_ba** ungerichtetes Beziehungsnetzwerk aus Quelle: Ausland (Spiegel und Handelsblatt) (3)

**Achtung:** Die Werte im Quellen Teilnetzwerk sind nicht gewichtet, sondern beschreiben nur die Beziehungen und Verbindungen zum Fall Wirecard anhand der jeweiligen Berichterstattung und gelten nur für dieses. Für die Analyse der anderen Beziehungen empfiehlt es sich, das EDGE-Attribut „weight", „relation" und „source2" zu löschen.

#### 4.2.1.1. Teilnetzwerke nach Quellen

*Generelle Teilnetzwerke*\
- Untersuchungsausschuss\
- Berichterstattung Inland\
- Berichterstattung Ausland

##### 4.2.1.1.1. Teilnetzwerk Untersuchungsausschuss

Für dieses Teilnetzwerk sollen nun nur noch die Beziehungen aus dem Untersuchungsausschuss Wirecards angezeigt werden. Damit wird das Netzwerk in ein neues Teilnetzwerk zerlegt, das nur noch aus Beziehungen dieser Quelle besteht:

##### 4.2.1.1.2. Teilnetzwerk Berichterstattung Inland

##### 4.2.1.1.3. Teilnetzwerk Berichterstattung Ausland

##### 4.2.1.1.4. Vergleich der Teilnetzwerke nach Quellen

### 4.2.2. Teilnetzwerke nach NODE-Attributen

### 4.2.3. Kombination der EDGE- und NODE-Attribute

## 4.3. Analyse der Teilnetzwerke: Componenten, Cluster und Cliquen

Die Analyse hat Teilnetzwerke nach spezifischen Kriterien generiert. Jedes Netzwerk verfügt aber auch über spezielle Eigenarten, wenn sich Knoten nach bestimmten Kriterien zusammenfinden.

Auf der Ebene des Netzwerks sind die Komponenten: Wenn keine isolierten Knoten existieren und alle Knoten in einem Hauptnetzwerk verbunden sind, dann liegt ein Netzwerk mit einer Komponente vor. Die Prüfung erfolgt mit dem Befehl is_connected(g). Achtung: manche Berechnungen von Netzwerkmaßen sind nur bei Netzwerken möglich, die aus einer Komponente bestehen.

### Komponenten

**Komponenten analysieren** Mit der Visualisierung sehen wir, dass das Studierendennetzwerk aus zwei Komponenten besteht: einer großen Hauptkomponente und einer kleineren Komponente aus sechs Knoten. Da insbesondere bei großen Netzwerken die Teilkomponenten nicht immer sichtbar sind, ist es hilfreich zu Beginn der Analyse sich alle Komponenten anzeigen zu lassen Der Befehl groups() zeigt an, welche Knoten zu welcher Komponente gehören.

## 4.4. Ego-Netzwerke

Manchmal ist es hilfreich, bestimmte Knoten aus dem Netzwerk zu extrahieren, um diese genauer zu untersuchen. Damit "zoomt" man auf einen Knoten im Netzwerk. Jedes Netzwerk besteht aus Egos (einzelne Knoten) und deren Alteri. Diese Ego-Netzwerke lassen sich auch einzeln analyisieren. Wir verwenden dafür die Befehle ego_size() und make_ego_graph().

Uns interessiert, wer im Netzwerkwc die meisten Beziehungen hat und dessen direktes Netzwerk. Deshalb selektieren wir zunächst den Knoten mit dem höchsten betweenness-Wert und erstellen danach das Ego-Netzwerk.

#### 4.4.1. Egonetzwerk Markus Braun (ohne Wirecard)

##### 4.4.1.1. Egonetzwerk Markus Braun erste Ordnung

```{r Egonetzwerk Markus Braun, fig.height=12, fig.width=8}
ego_size

wc_mb1 <- make_ego_graph(wc_ow, order = 1, nodes = V(wc_ow)$name2 == "MB", mode ="all")

wc_mb1

wc_mb1 <- wc_mb1[[1]]
wc_mb1

plot(wc_mb1,
     asp=0,
     layout=layout_with_kk,
     edge.arrow.size=.5,
     vertex.size=bs*80+5,
     edge.curved=curve_multiple(wc_mb1),
     main="Markus-Braun-Netzwerk",
     sub="Collar-Crime",
     vertex.label=V(wc_mb1)$name2)
```

##### 4.4.1.2. Egonetzwerk Markus Braun, zweite und dritte Ordnung

Ego-Netzwerke lassen sich leicht um die zweite oder dritte Ordnung erweitern. Dies ermöglicht eine genauere Analyse der Beziehungen um den Ego-Knoten.

```{r Egonetzwerk Markus Braun, fig.height=12, fig.width=8}
ego_size

#zweitee Ordnung
wc_mb2 <- make_ego_graph(wc_ow, order = 2, nodes = V(wc_ow)$name2 == "MB", mode ="all")

wc_mb2

wc_mb2 <- wc_mb2[[1]]
wc_mb2

plot(wc_mb2,
     asp=0,
     layout=layout_with_kk,
     edge.arrow.size=.5,
     vertex.size=bs*80+5,
     edge.curved=curve_multiple(wc_mb2),
     main="Markus-Braun-Netzwerk",
     sub="Collar-Crime",
     vertex.label=V(wc_mb2)$name2)

# dritte Ordnung
wc_mb3 <- make_ego_graph(wc_ow, order = 2, nodes = V(wc_ow)$name2 == "MB", mode ="all")

wc_mb3

wc_mb3 <- wc_mb3[[1]]
wc_mb3

plot(wc_mb3,
     asp=0,
     layout=layout_with_kk,
     edge.arrow.size=.5,
     vertex.size=bs*80+5,
     edge.curved=curve_multiple(wc_mb3),
     main="Markus-Braun-Netzwerk",
     sub="Collar-Crime",
     vertex.label=V(wc_mb3)$name2)

# Darstellung als Vergleich:

par(mfrow=c(1,3), mar=c(0,0,1,2))
plot(wc_mb1, edge.arrow.size=.3, main="Erster Grad")
plot(wc_mb2, edge.arrow.size=.3,  main="Zweiter Grad")
plot(wc_mb3, edge.arrow.size=.3, main="Dritter Grad")

par(mfrow=c(1,1), mar=c(0,0,1,2))

```

##### 4.4.1.3. Egonetzwerk Markus Braun, Cluster Walktrap Alg.

```{r Egonetzwerk Markus Braun, Cluster Walktrap Algorithmus fig.height=8, fig.width=8}
   
is_connected(wc_mb3)

cw <- cluster_walktrap(wc_mb3) # wendet die Clusterung auf das Netzwerk an
modularity(cw) # berechnet den Modularitätswert
membership(cw) # weist die Mitgliedschaft in die Community zu
plot(cw, wc_mb3,
     vertex.label=V(wc_mb3)$name2,
     edge.curved=curve_multiple(wc_mb3)) 
```

#### 4.4.2 Egonetzwerk Jan Masalek (ohne Wirecard)

##### 4.4.2.1. Egonetzwerk Jan Masalek, erste Ordnung

```{r Egonetzwerk Markus Braun, fig.height=8, fig.width=8}
ego_size

wc_jm1 <- make_ego_graph(wc_ow, order = 1, nodes = V(wc_ow)$name2 == "JM", mode ="all")

wc_jm1

wc_jm1 <- wc_jm1[[1]]
wc_jm1

V(wc_jm1)[V(wc_jm1)$type == 1]$shape = "circle"
V(wc_jm1)[V(wc_jm1)$type == 2]$shape = "square"
V(wc_jm1)[V(wc_jm1)$type == 1]$color = "peru"
V(wc_jm1)[V(wc_jm1)$type == 2]$color = "royalblue"

plot(wc_jm1,
     asp=0,
     layout=layout_with_kk,
     edge.arrow.size=.5,
     vertex.size=bs*80+5,
     edge.curved=curve_multiple(wc_jm1),
     main="Markus-Braun-Netzwerk",
     sub="Collar-Crime",
     vertex.label=V(wc_jm1)$name2)
```

##### 4.4.2.2. Egonetzwerk Jan Masalek zweite und dritte Ordnung

```{r Egonetzwerk Jan Masalek, fig.height=5, fig.width=8}

#zweitee Ordnung
wc_jm2 <- make_ego_graph(wc_ow, order = 2, nodes = V(wc_ow)$name2 == "JM", mode ="all")

wc_jm2

wc_jm2 <- wc_jm2[[1]]
wc_jm2

V(wc_jm2)[V(wc_jm2)$type == 1]$shape = "circle"
V(wc_jm2)[V(wc_jm2)$type == 2]$shape = "square"
V(wc_jm2)[V(wc_jm2)$type == 1]$color = "peru"
V(wc_jm2)[V(wc_jm2)$type == 2]$color = "royalblue"

plot(wc_jm2,
     asp=0,
     layout=layout_with_kk,
     edge.arrow.size=.5,
     vertex.size=bs*80+5,
     edge.curved=curve_multiple(wc_jm2),
     main="Jan-Masalek-Netzwerk",
     sub="Collar-Crime",
     vertex.label=V(wc_jm2)$name2)

# dritte Ordnung
wc_jm3 <- make_ego_graph(wc_ow, order = 2, nodes = V(wc_ow)$name2 == "JM", mode ="all")

wc_jm3

wc_jm3 <- wc_jm3[[1]]
wc_jm3

V(wc_jm3)[V(wc_jm3)$type == 1]$shape = "circle"
V(wc_jm3)[V(wc_jm3)$type == 2]$shape = "square"
V(wc_jm3)[V(wc_jm3)$type == 1]$color = "peru"
V(wc_jm3)[V(wc_jm3)$type == 2]$color = "royalblue"

plot(wc_jm3,
     asp=0,
     layout=layout_with_kk,
     edge.arrow.size=.5,
     vertex.size=bs*80+5,
     edge.curved=curve_multiple(wc_jm3),
     main="Markus-Braun-Netzwerk",
     sub="Collar-Crime",
     vertex.label=V(wc_jm3)$name2)

# Darstellung als Vergleich:

par(mfrow=c(1,3), mar=c(0,0,1,2))
plot(wc_jm1, edge.arrow.size=.3, main="Erster Grad")
plot(wc_jm2, edge.arrow.size=.3,  main="Zweiter Grad")
plot(wc_jm3, edge.arrow.size=.3, main="Dritter Grad")

par(mfrow=c(1,1), mar=c(0,0,1,2))

```

##### 4.4.2.3. Egonetzwerk Jan Masalek, Cluster Walktrap Alg.

```{r Egonetzwerk Markus Braun, Cluster Walktrap Algorithmus fig.height=6, fig.width=8}
   
is_connected(wc_jm3)

cw <- cluster_walktrap(wc_jm3) # wendet die Clusterung auf das Netzwerk an
modularity(cw) # berechnet den Modularitätswert
membership(cw) # weist die Mitgliedschaft in die Community zu
plot(cw, wc_jm3,
     vertex.label=V(wc_jm3)$name2,
     edge.curved=curve_multiple(wc_jm3)) 
```

## 4.5. Zentralitäts- und Netzwerkmaße

Je nach Auswahl des Netzwerks unterscheiden sich die Analyseergebnisse stark. Deshalb ist es notwendig zunächst zu klären, welche Netzwerke untersucht werden sollen.

Damit die Daten konsistent bleiben, werden hier das vereinfachte Gesamtnetzwerk sowie die vereinfachten Unternetzwerke erneut erstellt. Das ist in der Regel nicht notwendig, dient hier aber der Absicherung der Datenkonsistenz.

### 4.5.1. Degree

Anhand des Degree-Werts werde die Knoten mit den am häufig stärksten Beziehungen ermittelt.
Eine Unterscheidung zwischen Indegree- und Outdegree ist hierbei nicht notwendig, da es sich bei Wirecard um ein ungerichtetes Netzwerk handelt.

```{r Degree-Berechnung}
# Berechnung des Degree-Werts
degree_wc <- degree(wc, normalized=T)
degree_wc

# Knoten mit dem höchsten Degree-Wert 
which.max(degree_wc)
# Den höchsten Degree hat Wirecard, den zweithöchsten Degree hat Jan Marsalek, dann kommt Markus Braun.
```

### 4.5.2. Betweenness und Broker im Netzwerk

```{r höchster Betweennes-Wert - Brokerfunktion}
wc_ow <- delete.vertices(wc, V(wc)[name2="Wirecard"])
bs <- betweenness(wc_ow, normalized=T)

bs

which.max(bs)

# Dauerhafte Markierung des Knoten 18 
# (in diesem Fall wir die Rahmenfarbe rot gesetzt)
V(wc_ow)[V(wc_ow)$name2=="MB"]$frame.color = "red"
V(wc_ow)[V(wc_ow)$industry==5]$color = "yellow"
V(wc_ow)[V(wc_ow)$industry!=5]$color = "grey"

vertex.attributes(wc_ow)


plot(wc_ow,
     asp=0,
     layout=layout_with_kk,
     #vertex.size=ds, # Knotengröße nach Gewicht
     vertex.size=bs*80+5,
     edge.arrow.size=.3,
     main = "Visualisierung Broker",
     sub = "höchster Broker-Wert in rot umrandet",
     vertex.label = NA)

```

Den höchsten Betweenness-Wert hat Wirecard. Den zweithöchsten Wert hat Jan Marsalek, danach Mark Tollentino.
Dadurch wird deutlich, dass diese Akteure eine besonders entscheidende Position im Netzwerk erfüllen und ohne sie vielfältige Verbindungen im Wirecard-Betrugsfall möglichwerweise nicht umgesetzt worden wären.

### 4.5.3. Closeness
```{r Closeness}
   
# Closeness Wert 
closeness(wc)
closeness(wc_mb1)
closeness(wc_mb2)
closeness(wc_mb3)
closeness(wc_jm1)
closeness(wc_jm2)
closeness(wc_jm3)

# Closeness-Werte aller Personen im Braun-Egonetzwerk
wc_mb3_close <- closeness (wc_mb3)
wc_mb3_close

# Person mit dem höchsten Closeness-Wert im Teilnetzwerk Braun anzeigen
which.max(wc_mb3_close)

# Closeness-Werte aller Personen im Masalek-Egonetzwerk
wc_jm3_close <- closeness (wc_jm3)
wc_jm3_close

# Person mit dem höchsten Closeness-Wert im Teilnetzwerk Masalek anzeigen
which.max(wc_jm3_close)
```

### 4.5.4. Analyse mit dem InfluenceR
```{r InfluenceR Paket: Analyse von einflussreichen Knoten, fig.height=9, fig.width=16, message=FALSE, warning=FALSE, paged.print=FALSE}

#hier wird einlesen
library(igraph)
library(influenceR)

# I ens(wc) ermittelt den Zugang zu strukturellen Löchern in einem Netzwerk
# II bridging(wc) berechnet die Knoten, die sogenannte Brücken, die es ermöglichen, schneller andere Knoten zu erreichen.
holes <- ens(wc_ow)
which.max(holes)

#Bridges von Wirecard
bridges <- bridging(wc_ow)
which.max(bridges)

# Größten und kleinster Wert bekommen eine Randfarbe zugewiesen.
V(wc)[V(wc)$name2 == "JM"]$frame.color <- "green"
V(wc)[V(wc)$name == "KTG"]$frame.color <- "red"

plot(wc, 
     layout=layout_nicely,
     main="Einflussreiche Knoten",
     sub="Strukturelle Löcher (grün) und Brücken (rot)",
     edge.arrow.size=.1,
     edge.color="black",
     vertex.color="royalblue",
     vertex.label.color="black"
     )
```

Bei der Ermittlung der Löcher und Brücken wurde das vereinfachte Netzwerk ohne Wirecard verwendet. Die Darstellung findet jedoch wieder im Gesamtnetzwerk statt. Das größte strukturelle Loch tritt beim Knoten "Jan Marsalek" auf.
Über den Knoten "Karl Theodork zu Guttenberg" wird jedoch eine sogenannte Brücke aufgebaut. Damit können über ihn schneller andere Knoten erreicht werden.

## 4.6. Erklärungsmuster

Für die Struktur von Netzwerken liegen einige Erklärungsmuster vor, dazu gehören Reziprozität, Transitivität und Homophilie.

Reziprozität ist die gegenseitige Anerkennung in Netzwerken, d.h. dass Knoten (in gerichteten Netzwerken) gegenseitig gegenseitig verbunden sind. Transitivität beschreibt die Möglichkeit, dass zwischen Knoten eine Weitergabe stattfindet während Homophilie die Ähnlichkeit von Knoten betont.

### 4.6.1. Reziprozität

Da das gesamte Wirecard-Netzwerk aus ungerichteten Beziehungen besteht, findet dieses Erklärungsmuster hier keine Anwendung.

### 4.6.2. Transitivität

### 4.6.3. Homophilie

# 5. Finale Visualisierung

## 5.1. Finales Gesamtnetzwerk

```{r Gesamtnetzwerk, include=FALSE, echo=FALSE, message=FALSE, warning=FALSE, paged.print=TRUE}
# erste Visualisierung des Pretests zur Wirecard-Erhebung

library(igraph)

# liest die Edgelist als "el" ein
el <- read.csv("https://raw.githubusercontent.com/elenagrunow/SNA/main/wirecard/network/edge_wirecard.csv", header=T, as.is=T, sep = ",")

# liest die Nodelist mit den Namen ein
nodes <- read.csv("https://raw.githubusercontent.com/elenagrunow/SNA/main/wirecard/network/node_wirecard.csv", header=T, as.is=T, sep = ",")

# zeigt die ersten sechs Zeilen der Nodelist und die Attribute der Nodes an
head(nodes)

# Zwischenschritt verbindet die Edge- und Nodelist zu einer Matrix
wc_matrix <- as.matrix(el)


# generiert ein igraph-Objekt (dataframe) aus der Matrix, das gerichtet ist (directed = true)
wc <- graph_from_data_frame(d=wc_matrix, vertices = nodes, directed=FALSE)

# ruft unser neues igraph-Objekt auf
wc

# generiert die Standard-Visualisierung des Netzwerks
plot(wc)

# definiert einige grafische Elemente, damit wir diese nicht immer wieder eingeben müssen
E(wc)$arrow.size <- .1
E(wc)$color="darkblue"
E(wc)$width <- E(wc)$weight
E(wc)$curved=.2
V(wc)$color = "lightblue"
V(wc)$frame.color = "white"
V(wc)$label.dist = 3
V(wc)$label.degree=6
V(wc)$label.cex=.8
V(wc)$label.family="Helvetica"
V(wc)$label.font=1
V(wc)$label.color="darkblue"

degree <- degree(wc)
degree

# einfacher plot

plot(wc,
     layout=layout_nicely,
     vertex.size =10,
     main="Wirecard-Netzwerk",
     sub="Collar-Crime",
     vertex.label=V(wc)$name2)

```

## 5.2. Finaler Vergleich Egonetzwerke der Broker 

# 6. Diskussion: Fazit, Limitationen und Ausblick

Limitiert werden die Ergebnisse dieser Netzwerkanalyse schon allein durch den Fakt, dass wir uns nur in öffentlich zugänglichen Quellen informieren konnten. So bleiben etwaige vorhandene, bisher unbekannte Verbindungen natürlich weiter unentdeckt. Zudem sind nicht alle Rechercheergebnisse der Journalistinnen und Journalisten auch validiert. Manche Beschuldigte bestreiten die Vorwürfe, die gegen sie erhoben werden. So kann diese Netzwerkanalyse keine Antworten auf die Fragen nach der Schuld oder Unschuld liefern, wie es bei diesem Crime-Thema vielleicht von Außenstehenden erwartet wird. Jedoch kann sie zum Verständnis beitragen, wie das offensichtlich kriminelle System Wirecard jahrelang funktionieren konnte.

In Zukunft wird es spannend zu sehen sein, ob es in der nächsten Legislaturperiode des Deutschen Bundestages einen zweiten Untersuchungsausschuss zur Aufklärung der Wirecard-Skandals geben wird. Eine Neuauflage nach der Bundestagswahl 2021 hat unter anderem der aktuelle Vorsitzende des Untersuchungsausschusses Wirecard, Kay Gottschalk MdB, in einem Hintergrundgespräch mit den Autorinnen und Autoren dieses Forschungsberichts gefordert. Wir würden es nach eingehender Beschäftigung mit dem Wirecard-Skandal begrüßen, wenn weiter aufgeklärt werden würde. Insbesondere Fragen zu den Rollen der Geheimdienste im Wirecard-Konstrukt bleiben nach wie vor offen.

# 7. Anlage

## 7.1. Literatur

\- Burgess, T.F & Shaw, N.E. (2010). Editorial Board Membership of Management and Business Journals: A Social Network Analysis Study of the Financial Times 40. British Journal of Management, 21(3), Special Issue: An international forum advancing theory and research, S.627-648.

\- Burt, R. (2007). Secondhand Brokerage: Evidence on the Importance of Local Structure for Managers, Bankers and Analysts. Academy of Management Journal 50, S. 119-148.

\- Gamper, M. (2020). Netzwerkanalyse - eine methodische Annäherung. In: Klärner, A., Gamper, M., Keim-Klärner, S., Moor, I., Von der Lippe, H., Vonneilich, N. (Hrsg.), Soziale Netzwerke und gesundheitliche Ungleichheiten. Wiesbaden: Springer VS, S.109-136.

\- Gamper, M. (2020). Netzwerktheorie- Ein Überblick. In: Klärner, A., Gamper, M., Keim-Klärner, S., Moor, I., Von der Lippe, H., Vonneilich, N. (Hrsg.), Soziale Netzwerke und gesundheitliche Ungleichheiten. Wiesbaden: Springer VS, S.49-64.

\- Gaugler, M. (2009). Sinnvoll oder skandalös? Personelle Verflechtungen von Parlament und Wirtschaft durch die Nebentätigkeiten der Abgeordneten. Eine Netzwerkanalyse. In: Schneider V., Janning F., Leifeld P., Malang T. (Hrsg.) Politiknetzwerke. Wiesbaden: VS Verlag für Sozialwissenschaften.

\- KPMG-Studie (2020): Wirtschaftskriminalität in Deutschland 2020,

<https://home.kpmg/de/de/home/media/press-releases/2020/08/kpmg-studie-wirtschaftskriminalitaet-in-deutschland-2020.html>

\- KPMG Analysis (2011) of global patterns of fraud: Who is the typical fraudster?, <https://www.icfp.co.za/sites/default/files/articles/who_is_the_typical_fraudster.pdf>

\- Krenn, K. (2010). Wirtschaftsforschung. In: Gamper, M. & Reschke, L. (Hrsg.) Knoten und Kanten: Soziale Netzwerkanalyse in Wirtschafts- und Migrationsforschung. Bielefeld: Transcript Verlag, S.119-144.

\- Pircher, R. (2010). Soziale Netzwerkanalyse in Organisationen-versteckte Risiken und Potentiale erkennen. In: Pircher, R. (Hrsg.), Wissensmanagement, Wissenstransfer, Wissensnetzwerke: Konzepte, Methoden und Erfahrungen. Erlangen: Publicis Publishing, S.211-231.

\- Raab, J. (2010). Netzwerke und Netzwerkanalyse in der Organisationsforschung. In: Stegbauer, C. & Häußling, R. (Hrsg.), Handbuch Netzwerkforschung. Wiesbaden: Springer VS, S.575-586.

\- Ricken, B. & Seidl, D. (2010). Unsichtbare Netzwerke: Wie sich die soziale Netzwerkanalyse für Unternehmen nutzen lässt. Wiesbaden: Springer VS.

## 7.2. Codebuch {#codebuch-1}

[Codebuch](#codebuch-1) <https://github.com/elenagrunow/SNA/blob/main/wirecard/network/Codebuch.Rmd>

```{r Übersicht Netzwerkattribute}

list.vertex.attributes(wc)

#vertex.attributes(wc)

list.edge.attributes(wc)

#edge.attributes(wc)

```

Das Netzwerk hat nach dem [Codebuch](#codebuch-1) <https://github.com/elenagrunow/SNA/blob/main/wirecard/network/Codebuch.Rmd> folgende Attribute:

*Vertex-Attribute* - id: ID wie in der Edgelist zur Identifikation der Knoten - name: Gesamter Name des Knotens - name2: Zweiter Name, um id für die Knoten verwenden zu können - sex: Geschlecht 1 weiblich, 2 männlich, 3 divers - influence: Einflussnahme des Akteurs aus Wirtschaft oder Politik 1 sehr gering, 2 gering, 3 kann Einfluss nehmen, 4 hoch, 5 sehr hoch - age: Alter der Personen 1 bis 25 Jahre, 2 30-40 Jahre, 3 41-60 Jahre, 4 61 und älter - position: Position im Unternehmen/Organisation 0 keine Angabe, 1 Top-Verantwortung, 2 Leader, 3 No responsibility - type: 0 Wirecard, 1 Person, 2 Organisation/Regierung/Unternehmen - industry: 1 Insider (Wirecard-Personal), 2 Banken/Wirtschaftsprüfer, 3 Journalisten/Whistleblower, 4 Justiz, 5 Politik, 6 Wirtschaft, 7 Ermittler (Polizei, Untersuchungsausschuss)\
- country: Hauptwohnsitz der Person, der Organisation - source1: 1 Untersuchungsausschuss, 2 Berichterstattung Inland, 3 Berichterstattung Ausland - source2: Link zu der Quelle

*Edge-Attribute* - id: Entspricht einer Abkürzung eines Mitarbeiters von Wirecard oder einer Person außerhalb des Unternehmens bzw. einer Organisation oder Behörde, die unmittelbar mit Wirecard in Verbindung stand - weight: Häufigkeit des Kontakts einer Person/Organisation/Behörde zu Wirecard 1 einmaliger Kontakt, 2 mehrmals Kontakt (2-4x), 3 häufiger Kontakt (ab 5x) - relation: Beziehungsart zwischen den Personen/Organisationen/Behörden und Wirecard 1 Beschäftigungsverhältnis/Zusammenarbeit/Mitarbeiter, 2 flüchtige Geschäftsbeziehung mit Wirecard (Beratung), 3 beeinflussende Geschäftsbeziehung (Lobbying), 4 andauernde Beziehung (Freundschaft), 5 Geldgeber, 6 Hinweisgeber, 7 Überprüfung, 8 Kunden, 9 Investoren

## 7.3. Datenmaterial und Skript

[Datensatz] <https://github.com/elenagrunow/SNA/tree/main/wirecard/network>\
Die Quellen der Datenerhebung sind in der Edge- und Nodelist codiert.

## 7.4. Team, Arbeitsaufwand und Lessons Learned

### 7.4.1. Teammitglieder

Elena Grunow\
Patchara Wieczorek\
Evelyn Fade\
Isabella Heider\
Kai Leitenberger\
Severin Köhler

### 7.4.2. Arbeitsaufwand und Rollen im Team

Elena Grunow: Projektleitung, Coding & Visualisierung, Datensammlung aus dem Untersuchungsausschuss Isabella Heider: Datensammlung aus dem Untersuchungsausschuss, Literaturrecherche für den Forschungsstand, Anlagen Patchara Wieczorek: Datensammlung aus der inländischen Berichterstattung, Erklärungsmuster für den Forschungsbericht Evelyn Fade: Datensammlung aus der inländischen Berichterstattung, Analyse der Teilnetzwerke für den Forschungsbericht, Interviews führen Kai Leitenberger: Datensammlung aus der ausländischen Berichterstattung, Abstract und Hinführung für den Forschungsbericht, Fazit und Ausblick des Forschungsberichts, Interviews führen Severin Köhler: Datensammlung aus der ausländischen Berichterstattung, Netzwerk- und Zentralitätsmaße des Forschungsberichts, Interviews anfragen und führen

### 7.4.3. Lessons Learned

Bitte beschreiben Sie kurz als Team, was ihre größte Herausforderung war und was der größte Lernerfolg in dem Projekt. Größte Herausforderung: Eine der größten Herausforderungen für uns war, die Fehlermeldungen zu beheben. Beispielsweise wollten wir die id als Label für die Knoten verwenden, was zuerst nicht funktionierte. Man muss zuerst ein neues Attribut mit name2 erstellen und die id dorthin kopieren, um die id als Label verwenden zu können. Zusätzlich war es herausfordernd eine doppelte Verwendung einer id in der Nodelist zu entlarven, vor allem bei einer Anzahl von über 100 Akteuren.

Eine schönere Visualisierung der Netzwerke stellte uns ebenfalls vor mehrere Herausforderungen. Bis die Größe der Knoten stimmte, die richtigen Farben eingesetzt wurden, die verschiedenen Formen funktionierten und alles so war, wie wir uns das vorgestellt hatten, vergingen mehrere Stunden.

Größter Lernerflog: Ein Lernerfolg, den wir aus dieser Projektarbeit mitgenommen haben, ist die Bedeutung von Kommunikation zwischen den einzelnen Teammitgliedern. Die Kommunikation im Team und die Verteilung der Aufgaben sind die Basis für ein erfolgreiches Teamprojekt. Genau wie die Zusammenarbeit das A und O ist, ganz nach dem Motto: Teamwork is Dreamwork! Ein großer Erfolg sind unser fertiges Gesamtnetzwerk, die einzelnen Teilnetzwerke sowie unser Forschungsbericht und unser Edit Artikel über unser Projekt. Jedoch haben wir die letzten zwei Semester festgestellt: Den „einen großen Erflog", den gibt es nicht. Es sind die kleinen, einzelnen Erfolge, egal wie klein sie auch sein mögen, die alle ihren Beitrag zum großen, gesamten Erfolg leisten.
